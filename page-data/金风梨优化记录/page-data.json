{"componentChunkName":"component---src-templates-blog-post-js","path":"/金风梨优化记录/","result":{"data":{"site":{"siteMetadata":{"title":"银凤梨"}},"markdownRemark":{"id":"f3000974-8eaf-537c-9b05-286abb1decc6","excerpt":"这次优化主要是针对站点首屏加载资源过多，拖慢首屏渲染而做出的优化尝试。 主要手段包括： 1、按需引入 iview，现在所有使用的 components 都要手动引入。 2、删除 prefetch 链接。具体参考vue-cli prefetch 一节。 3、gzip 压缩。 4、按需引入 highlight.js…","html":"<p>这次优化主要是针对站点首屏加载资源过多，拖慢首屏渲染而做出的优化尝试。</p>\n<p>主要手段包括：</p>\n<p>1、按需引入 iview，现在所有使用的 components 都要手动引入。</p>\n<p>2、删除 prefetch 链接。具体参考<a href=\"https://cli.vuejs.org/zh/guide/html-and-static-assets.html#prefetch\">vue-cli prefetch 一节</a>。</p>\n<p>3、gzip 压缩。</p>\n<p>4、按需引入 highlight.js</p>\n<p>使用 Lighthouse 测试后会发现在首页测试中，performance 一项的得分由原来的 22 上涨到 88 分。效果也是比较好的。</p>\n<h2>按需引入 ivew</h2>\n<p>相关记录在项目 plugins/iview 文件，现在需要手动导入所需 components</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1bc35606fd9793930228f008fd10e1ed/7a4b2/1240-20200817211859449.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.08108108108109%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAAC+UlEQVQoz1WQ3U+TZxyG3/9g/8KOlmxHZhkfgthidFuyLFmUsGiMZoKwuaEFt1UMKApWnJukU4TViYXZFWhTwEGFQoBCP2hpXyoq9vPtu8L4KNKSJVt0Hlx7VzzZwZX7/j0Hd/JcwuqTHvxjV/DaW5h36Jh72JLr/jEd7uFm3CPNiBM6UiEjhtYsP9T/yTXtKhdrwjTXylyp+4NzFSmqP4mhOSIhSO5G4s6z/O7RIo7UMN1XhW/wFE4lF0fPILu1xKY1xGcv4XKkmRhZY3Z8E1vPBl16CaN+k9Ofynz4TpiDeQkE2X8VyduI5LlAwP4NrgENTybrSXov5t6S3iaiLiX9N/DNLjPpiOCZkRkyp7nVsoK+aZ1Th5Ko3nLxUZ4DYSNqYSNizpGO9JKO9iq9d+dWuix2EPFeJ+b/iXFbhiFTmjHrNvd/zHD5yxVqy9coKwzy9hs3ee9N3c7gZqyPrYQ1x/O45TX9ymA/y6Ke+H9aPK0MDSa427XAr+Ywtw2rNLck+PbsOpWVEQ4fdXH0WABhM2YltdhD2Pczz+buIC0YiQfvkRDv5QZTwTZCQ2X8cl1F+7iP70YDNNjc6CeW+apfRmN+zmc3/6K64x8Otb5EyEg2FpztmAxajO1fYzU20Nd1nt/Ml5RBCzFXEz5rGdOWKi6bRqnpfEBVxzCnjVHyzwxzpC3IcdPflN/Z5uOOFztfXg+bFXbcrSskQ92sPL2vqLAQdjbgtRwm5KjFsBjg2ryPVq+HOrtMeecUn1uXqBjJYn+cwbmURdhK2BR3FjIKW6/JStbcnUkOILnrme1WIT6soFMO8H14jqvLIdpWt2lMZqmNvKRSfEXKPkjG8QAhGugmOt9FRCH6P+4qLrsRHeeYMpXhHqjGIE5zyzdFU2ASzaOnHFtY4sTjFb4IrBGcmWFp3o/w/gdq1OpiinYXoFbtoaSkGJWSpaoi1HuLqWs8jlZ3kj3FBeQXFbF3X6mSu3k3L49d+fnsKiykoKSE0gMH2Ld/P/8COIeLGJVNwTYAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"image\"\n        src=\"/static/1bc35606fd9793930228f008fd10e1ed/fcda8/1240-20200817211859449.png\"\n        srcset=\"/static/1bc35606fd9793930228f008fd10e1ed/12f09/1240-20200817211859449.png 148w,\n/static/1bc35606fd9793930228f008fd10e1ed/e4a3f/1240-20200817211859449.png 295w,\n/static/1bc35606fd9793930228f008fd10e1ed/fcda8/1240-20200817211859449.png 590w,\n/static/1bc35606fd9793930228f008fd10e1ed/efc66/1240-20200817211859449.png 885w,\n/static/1bc35606fd9793930228f008fd10e1ed/c83ae/1240-20200817211859449.png 1180w,\n/static/1bc35606fd9793930228f008fd10e1ed/7a4b2/1240-20200817211859449.png 1240w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/101dcdee3e50dafbda01afbfba55e26f/7a4b2/1240-20200817211859633.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.08108108108109%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAADIUlEQVQozx2R20/TBwCF+wfs2T0s2dtefHJEuZWKGHHIjIsEo2CmQRhMRZHLMI4AETQbLCyTObpQCHUi13VtYZWfvdALtOVHkdLSdtiWQmkLjUMGxgyTZfvW7eF7OsmXc3IkEec9AsZaAqZ6vM9q8Rnq8OrrWNTdYHW2CaNuBmW/ldHBWYYeWXnyH8pZ1KoZFB073DzzlsbSPW6X/EXVyT+RvHSWsWUrZkl9Bv/EJ7hVp1gYK2DTeo7fHReZtz7HKESYmvSg0ywxPuzk5+F5TPplhnp2aLwcpqnSzde1m1wt3EWyvVDNinCBBfV5tuxlJMUaEo5r+FTpOJSHWH/hJxjcIhJOsL76CsOUh5FBK1MTTvr6trlV/w+1DX/zadkuFy4GkSRDWrZWxlh1PWTD9RVJ911eiuXM9r6PvPEAvkUXoujDJXpY9qwh6Lyox90MKWfo749xveE1WflveOfdeQ68dwdJzDdK3Ksg4e5iY/4e8dkKYuazLI7mYFBICS4HCAdfsxrcZtm9xeQvXgZ67Qz02OiSR6lo26Pq7h/kfxahsMqFJCJ2ErE3EXV8wYb9FnH7VeKOm0Qtl0jYy5mz2Bl+YkY1Zkb/1ItqxM2P3VZ+6DTR/J2P4vYQpR1JZI37HPx8H0lIfMCKrQW/cIXQsyLilnPErKXEpk8T0OSiGdGjkM+hVDiQd8/Q0Wak9ctfaakbo2XAT6XmFeXKPYrkbyjpTQk3xTriKUHUVETCcpZ1UzFrphL86mxcQxn89L2K29WPuX9nnOYaHecLeij5uJv6kj4udzpJG0xSbXjLY9ce2sXUywlnDeHpcsLmStZsqbnGk4Q0hwhPZKQa5qB1TdM/95wBu4OHgo1v1AL3JwXaNRO0usJUBPZpi8KmoGXXoEXywtJAwHDtf1ZMN3AMytA9+ID5oRxsj44irOh5GvegDc2hDjoQIi66gnoK7d9yXTRzyb1N6287LFlt+EURyUcFxzieJyUnO528Y1Kk0mxkMim5sgzycrOob75CY3tVKs8m/UgmshwZmRmZfHj4MGlH0knLzEKae5S8/HyOnzjBvzEpeS1PSpLqAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"image\"\n        src=\"/static/101dcdee3e50dafbda01afbfba55e26f/fcda8/1240-20200817211859633.png\"\n        srcset=\"/static/101dcdee3e50dafbda01afbfba55e26f/12f09/1240-20200817211859633.png 148w,\n/static/101dcdee3e50dafbda01afbfba55e26f/e4a3f/1240-20200817211859633.png 295w,\n/static/101dcdee3e50dafbda01afbfba55e26f/fcda8/1240-20200817211859633.png 590w,\n/static/101dcdee3e50dafbda01afbfba55e26f/efc66/1240-20200817211859633.png 885w,\n/static/101dcdee3e50dafbda01afbfba55e26f/c83ae/1240-20200817211859633.png 1180w,\n/static/101dcdee3e50dafbda01afbfba55e26f/7a4b2/1240-20200817211859633.png 1240w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/71f32fb5f69b5001e8ebdde89a5b4988/7a4b2/1240-20200817211859569.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.08108108108109%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAADGklEQVQozx2R20/bdRiH+z94oYnZhTFxV5tTGIzC2jIORSdiFINmTuJhcStiwENmjAm6xIRp1IhBNrG2G6xjQA+UQwuldNAB5dSWnvvrDwpdp9LByog7qBePX7148nnzXjx5D4rU7DkCY82EJlqJuFoErQSdLayMnkHytjM5uI5ZH8bUtcilDi/676cwdszQ27mA5dcQY6abNB3P85Zql7qDERTSRAMRu5ZV23P4zTUs9mvxW54nZKsi6TrN2JUE9kspBrqDQuITkghWQwybIYn5lxA2o8zphh0aX7jDKxUxFFtzJ8h5a0mOVjNv0rDYp2LTVUXWVUbG8waJwBap8F2Sq9uCHVHvit4OLmsS50AY52CalpY/aXp/mzcb/0GR9Z0lO9tM3HmCyEg9srOWdWc1qaFnWZuoJzi/gXcyJogy70nim5YI+rKYOiIYzgcwG2R0n/2F7vP7nGx9KCZc/pg/fGfIXH8dyVGLNFJBalhJyrKf9PhLQhLn6mWnwMFlvZ0rxhEhlWlvneGrD1z0dcc5rrtP5ak8VSIVsucUCWcDGXcdG+MVyCNHkIcOIQ3sIzVSg+y/TTq0x3po93+kgFh9ZQdD+zI/fDJD57lldF33aLr4gHd+fCCE7pMkHXVsTlQhD/8nexrZup+o6TFi4lk3Ihmmw1m8kZt4/GmmBd7VDD19ES78vETPQJy3Tfdo7HlI/U93xZedLxO3l7M2WopkOyRWfYrEwJMs6R9lyarFlUsznttkKCtxLRXCKAcxrIf4Or3CawtWmqNztEzt8a13j2+m8mJCh5aouYB1+wHWLE8g9T/Oau8+5i8+wuJgNbntHPk7eUJbt5i7tYF5M0F3OsxH4RkOmr6j7JqRttjfbLsd3F6cRbFieZHZXhWBfiX+vsPcMBZwXV+Iq+sAnquvsvZ7ho3cbwxH/ZiCPi4E5/hyyc17bguFHW2o2z6lU5wkNukisrCAQluj4Vh5KcqSYjTqMlSqMtQiy9VKNKpSPvziXc6e11F6VEnRkRKOqlUUK0soKC7imaJCCg4XotKoKNdWc6yykn8BUSt98LW8/U4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"image\"\n        src=\"/static/71f32fb5f69b5001e8ebdde89a5b4988/fcda8/1240-20200817211859569.png\"\n        srcset=\"/static/71f32fb5f69b5001e8ebdde89a5b4988/12f09/1240-20200817211859569.png 148w,\n/static/71f32fb5f69b5001e8ebdde89a5b4988/e4a3f/1240-20200817211859569.png 295w,\n/static/71f32fb5f69b5001e8ebdde89a5b4988/fcda8/1240-20200817211859569.png 590w,\n/static/71f32fb5f69b5001e8ebdde89a5b4988/efc66/1240-20200817211859569.png 885w,\n/static/71f32fb5f69b5001e8ebdde89a5b4988/c83ae/1240-20200817211859569.png 1180w,\n/static/71f32fb5f69b5001e8ebdde89a5b4988/7a4b2/1240-20200817211859569.png 1240w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2>删除 prefetch</h2>\n<p>原来的策略会尽早 fetch 所有的 js 和 css，这不是我想要的，所以我通过 vue 文档中的 prefetch 一节，删除掉 prefetch 链接。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b4205ee9c6f394a8e8fb4af650760ea9/7a4b2/1240-20200817211859600.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.08108108108109%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAAB+0lEQVQoz31Sy5LTMBD0X5Fk10kIRfEbHDly48KZT+CP9kTxKK7EoWI7yW4iy7Jelp/NSMmGFAdU1aWxJPf09EykFcPxsIV1DbquxzgirKbvcJAcgh/Bn04oWAklDYwysNahaRpIqQiSvmuChdYakaHL4nSEECIcdl0XMPR9IJZ0r7hAlnH8ygxYYWFNC5+3tUTOOVxdhwSBUCsBwfbo+4HUjRgI4w2kNtClwDqt8HVtkKT0vrQhmaoqggxkxpigNvKB4AxKaSLtA8bnur1CT0gKN0T4PTFI8wpauXDnSJEuzgpbqqqmCiMlBR6zDQz54MmGYbjCE+vawYgKm6zCDyLM95KSnwk1KSoOB8hKBIVnD41FyQv4vfaZ2jYQP+9108FWikqt8I1KznfiqlCXJY77A+gJun68eHhRKC8lj/94aF0bCLdUapIrPD5J8LImggG+M62ls98PsCILjYoUeeQlO+eCqlv4MTK177JEyRTKqoHSDTXh4rUfL83w8+EzWPolqI5cbVCeduiHv424XW1HfrbeAh8jqPrfirZpivV6jSRJkOc5zVsW9it2O5zYCZx89ig8igKMsQAfFzSLARRHr9+8wnwRYzKZYLlc4O4+RjyfUxxjMY/x/uNbfPj0DnF8j8l0RudL3M1m9P5F+Gc69f/NsVq9JKzwBy1yJdfHJ1WdAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"image\"\n        src=\"/static/b4205ee9c6f394a8e8fb4af650760ea9/fcda8/1240-20200817211859600.png\"\n        srcset=\"/static/b4205ee9c6f394a8e8fb4af650760ea9/12f09/1240-20200817211859600.png 148w,\n/static/b4205ee9c6f394a8e8fb4af650760ea9/e4a3f/1240-20200817211859600.png 295w,\n/static/b4205ee9c6f394a8e8fb4af650760ea9/fcda8/1240-20200817211859600.png 590w,\n/static/b4205ee9c6f394a8e8fb4af650760ea9/efc66/1240-20200817211859600.png 885w,\n/static/b4205ee9c6f394a8e8fb4af650760ea9/c83ae/1240-20200817211859600.png 1180w,\n/static/b4205ee9c6f394a8e8fb4af650760ea9/7a4b2/1240-20200817211859600.png 1240w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2>gzip 压缩</h2>\n<p>通过在服务器配置 gzip 选项，压缩 1k 以上的 ascii 文档。配置/etc/nginx/nginx.conf 中 gzip 等选项可以做到。</p>\n<p>接下来可以尝试使用 cdn 和 cache-control，加速站点。</p>","frontmatter":{"title":"金风梨优化记录","date":"December 12, 2019","description":""}}},"pageContext":{"slug":"/金风梨优化记录/","previous":null,"next":{"fields":{"slug":"/版本金凤梨酥日志/"},"frontmatter":{"title":"版本金凤梨酥日志"}}}}}